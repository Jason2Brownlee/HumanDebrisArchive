<script type="text/javascript" src="/_static/js/bundle-playback.js?v=1WaXNDFE" charset="utf-8"></script>
<script type="text/javascript" src="/_static/js/wombat.js?v=txqj7nKC" charset="utf-8"></script>
<script type="text/javascript">
  __wm.init("https://web.archive.org/web");
  __wm.wombat("http://www.ict.swin.edu.au:80/personal/jbrownlee/other/games/tutorials/Kamikaze.html","20071210024417","https://web.archive.org/","web","/_static/",
	      "1197254657");
</script>
<link rel="stylesheet" type="text/css" href="/_static/css/banner-styles.css?v=S1zqJCYt" />
<link rel="stylesheet" type="text/css" href="/_static/css/iconochive.css?v=qtvMKcIJ" />
<!-- End Wayback Rewrite JS Include -->
<script id="hostedAdCode"></script><script src="https://web.archive.org/web/20071210024417js_/http://web.archive.org/web/20021110122251js_/http://ads.gamespy.com/jserver/SITE=PQ/AREA=HOSTED/GENRE=ACTION/TIER=3/AAMSZ=PRESTITIAL?1028811579"></script><!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
<base href="https://web.archive.org/web/20071210024417/http://www.planetquake.com/humandebris/tutorials/Kamikaze-Tutorial/Kamikaze.html">

   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.7 [en] (Win98; I) [Netscape]">
   <meta name="Author" content="Jason [ Zygote ] Brownlee">
   <meta name="Description" content="Kamikaze Key">
   <title>Kamikaze Key</title>
</head>
<body text="#C0C0C0" bgcolor="#000000" link="#3366FF" vlink="#3366FF" alink="#FF0000">
<b><font face="Verdana"><font color="#FFFFFF"><font size="+1">Kamikaze
Key</font></font></font></b>
<br><font face="Verdana"><font size="-1"><font color="#FFFFFF">Code Tutorial
- by</font> <a href="https://web.archive.org/web/20071210024417/mailto:hop_cha@hotmail.com">Zygote</a> (<a href="https://web.archive.org/web/20071210024417/http://www.planetquake.com/humandebris">HUMAN
DEBRIS</a>)</font></font>
<br>&nbsp;
<p><b><font face="Verdana"><font color="#FFFFFF"><font size="-1">What the
hell is a "Kamikaze Key"?</font></font></font></b>
<br><font face="Verdana"><font size="-1">Everybody knows the "kill" console
command, where when it is issued the player will instantly commit suicide
on the spot, and loose a frag. This tutorial takes the "kill" command one
step further, where the player will not only suicide, but will go with
a blast that will take other players with them.</font></font><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font size="-1"><b><font color="#FFFFFF">Note:</font></b>
I am not the worlds greatest programmer by a long shot, so don't go crazy
if you see a bit of bad programming in this tutorial. I would appreciate
any suggested improvements or corrections you can offer. The code has been
tested extensively and works fine.</font></font>
<br><font face="Verdana"><font size="-1">In doing this tutorial I assume
you know how to compile the source, and have played with the code before.</font></font><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font size="-1">Okay, on with the tutorial.</font></font>
<br><font face="Verdana"><font size="-1">This modification requires one small
change in the client code, and the rest is done in the server code.</font></font>
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;<font face="Verdana"><font size="-1"></font></font>
<p><b><font face="Verdana"><font color="#FFFFFF"><font size="-1">Outline:</font></font></font></b>
<br><font face="Verdana"><font size="-1">Add a new console command based
on the "kill" command</font></font>
<br><font face="Verdana"><font size="-1">Add blast functionality to the new
command</font></font>
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;<font face="Verdana"><font size="-1"></font></font>
<p><b><font face="Verdana"><font color="#FFFFFF"><font size="-1">Modified
Files:</font></font></font></b>
<br><u><font face="Verdana"><font size="-1">CGAME:</font></font></u>
<br><font face="Verdana"><font size="-1">cg_consolecmds.c</font></font><font face="Verdana"><font size="-1"></font></font>
<p><u><font face="Verdana"><font size="-1">GAME:</font></font></u>
<br><font face="Verdana"><font size="-1">g_cmds.c</font></font>
<br><font face="Verdana"></font>&nbsp;<font face="Verdana"></font>
<p><b><font face="Verdana"><font color="#FFFFFF"><font size="-1">Adding the
new Command</font></font></font></b><font face="Verdana"><font size="-1"></font></font>
<p><b><font face="Verdana"><font color="#FFFFFF"><font size="-1">cg_consolecmds.c</font></font></font></b>
<br><font face="Verdana"><font size="-1">Go down to the bottom of the file
and find the <font color="#FFFFCC">CG_InitConsoleCommands</font> function.</font></font>
<br><font face="Verdana"><font size="-1">Find the following line:</font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">trap_AddCommand
("kill");</font></font></font><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font size="-1">Now put the following line directly
below it:</font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">trap_AddCommand
("kamikaze");</font></font></font><font face="Verdana"></font>
<p><b><font face="Verdana"><font color="#FFFFFF"><font size="-1">g_cmds.c</font></font></font></b>
<br><font face="Verdana"><font size="-1">Go down to a bit before half way
down the file and find the following code:</font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">/*</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">=================</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">Cmd_Kill_f</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">=================</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">*/</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">void Cmd_Kill_f(
gentity_t *ent ) {</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;if (
ent-&gt;client-&gt;sess.sessionTeam == TEAM_SPECTATOR ) {</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp; return;</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;}</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;ent-&gt;flags
&amp;= ~FL_GODMODE;</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;ent-&gt;client-&gt;ps.stats[STAT_HEALTH]
= ent-&gt;health = 0;</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;player_die
(ent, ent, ent, 100000, MOD_SUICIDE);</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">}</font></font></font>
<br><font face="Verdana"><font size="-1">This will be the basis for our new
kamikaze command.</font></font><font face="Verdana"></font>
<p><b><u><font face="Verdana"><font size="-1">Analysis:</font></font></u></b>
<br><font face="Verdana"><font size="-1">If the Player is dead, go no further.</font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;if (
ent-&gt;client-&gt;sess.sessionTeam == TEAM_SPECTATOR ) {</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp; return;</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;}</font></font></font><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font size="-1">The player is not in GOD_MODE</font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;ent-&gt;flags
&amp;= ~FL_GODMODE;</font></font></font><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font size="-1">Set the players health to 0, and
run the player_die function (normal death protocols)</font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;ent-&gt;client-&gt;ps.stats[STAT_HEALTH]
= ent-&gt;health = 0;</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;player_die
(ent, ent, ent, 100000, MOD_SUICIDE);</font></font></font>
<br><font face="Verdana"></font>&nbsp;<font face="Verdana"></font>
<p><font face="Verdana"><font size="-1">Directly below the above <font color="#FFFFCC">Cmd_Kill_f</font>
function, place the following:</font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">/*</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">=================</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">Cmd_Kamikaze_f&nbsp;&nbsp;
--- ZYGOTE</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">=================</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">*/</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">void Cmd_Kamikaze_f(
gentity_t *ent ) {</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">&nbsp;if (
ent-&gt;client-&gt;sess.sessionTeam == TEAM_SPECTATOR ) {</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">&nbsp; return;</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">&nbsp;}</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">&nbsp;ent-&gt;flags
&amp;= ~FL_GODMODE;</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">&nbsp;ent-&gt;client-&gt;ps.stats[STAT_HEALTH]
= ent-&gt;health = 0;</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">&nbsp;player_die
(ent, ent, ent, 100000, MOD_SUICIDE);</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">}</font></font></font>
<br><font face="Verdana"><font size="-1">You will notice that this is an
exact copy of the <font color="#FFFFCC">Cmd_Kill_f </font><font color="#C0C0C0">function,
with a slight name change.</font></font></font><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font size="-1">Now go down the the bottom of that
file and find the following lines:</font></font>
<br><font face="Verdana"><font size="-2">&nbsp;<font color="#FFFFCC">else
if (Q_stricmp (cmd, "kill") == 0)</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp; Cmd_Kill_f
(ent);</font></font></font><font face="Verdana"></font>
<p><font face="Verdana"><font size="-1">Directly below those two lines, place
the following:</font></font>
<br><font face="Verdana"><font size="-2">&nbsp;<font color="#FF6666">else
if (Q_stricmp (cmd, "kamikaze") == 0)</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">&nbsp; Cmd_Kamikaze_f
(ent);</font></font></font><font face="Verdana"></font>
<p><font face="Verdana"><font size="-1">Now we have a console command called
"kamikaze" that when issued will kill the player exactly the same as the
"kill" console command.</font></font>
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;<font face="Verdana"><font size="-1"></font></font>
<p><b><font face="Verdana"><font color="#FFFFFF"><font size="-1">Adding the
Blast to the Kamikaze</font></font></font></b>
<br><b><font face="Verdana"><font color="#FFFFFF"><font size="-1">g_cmds.c</font></font></font></b>
<br><font face="Verdana"><font size="-1">Go back up to our&nbsp;<font color="#FF6666">
Cmd_Kamikaze_f </font><font color="#C0C0C0">function</font></font></font><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font color="#C0C0C0"><font size="-1">Find the following
lines:</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">if ( ent-&gt;client-&gt;sess.sessionTeam
== TEAM_SPECTATOR ) {</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp; return;</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;}</font></font></font><font face="Verdana"></font>
<p><font face="Verdana"><font color="#C0C0C0"><font size="-1">Place the following
lines directly below:</font></font></font>
<br><font face="Verdana"><font size="-2"><font color="#C0C0C0">&nbsp;</font><font color="#FF6666">if
( ent-&gt;client-&gt;ps.pm_type &gt;= PM_DEAD ) {</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">&nbsp; return;</font></font></font>
<br><font face="Verdana"><font color="#FF6666"><font size="-2">&nbsp;}</font></font></font>
<br><font face="Verdana"><font color="#C0C0C0"><font size="-1">This will
break out of the function if the player issuing the command is already
dead.</font></font></font><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font color="#C0C0C0"><font size="-1">Find the following
two lines:</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;ent-&gt;client-&gt;ps.stats[STAT_HEALTH]
= ent-&gt;health = 0;</font></font></font>
<br><font face="Verdana"><font color="#FFFFCC"><font size="-2">&nbsp;player_die
(ent, ent, ent, 100000, MOD_SUICIDE);</font></font></font><font face="Verdana"></font>
<p><font face="Verdana"><font color="#C0C0C0"><font size="-1">Replace them
both with:</font></font></font>
<br><font face="Verdana"><font size="-2"><font color="#FFFFCC">&nbsp;</font><font color="#FF6666">G_RadiusDamage(
ent-&gt;r.currentOrigin, ent, 1000, 200, NULL, MOD_GAUNTLET );</font></font></font><font face="Verdana"></font>
<p><font face="Verdana"><font size="-1">This line calls the G_RadiusDamage
function and passes 6 parameters:</font></font>
<br><font face="Verdana"><font size="-1">&nbsp;1)=where the player is, 2)=attacker(myself),
3)=damage, 4)=radius, 5)=who not to dmg, 6)=Method Of Death (type of message
to be displayed)</font></font><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font size="-1">The MOD (Method Of Death) that the
"kill" command uses is: <font color="#FFFFCC">MOD_SUICIDE</font></font></font>
<br><font face="Verdana"><font size="-1">If we put this as the MOD then when
to ran up to grunt in game and pressed "kamikaze", it would say:</font></font>
<br><i><font face="Verdana"><font color="#99FF99"><font size="-1">Player
committed suicide</font></font></font></i>
<br><i><font face="Verdana"><font color="#99FF99"><font size="-1">Grunt committed
suicide</font></font></font></i><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font size="-1">If we put MOD_GAUNTLET as the MOD
then the following messages would be displayed in the same situation:</font></font>
<br><i><font face="Verdana"><font color="#99FF99"><font size="-1">Player
killed himself</font></font></font></i>
<br><i><font face="Verdana"><font color="#99FF99"><font size="-1">Grunt was
pummeled by Player</font></font></font></i>
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;<font face="Verdana"><font size="-1"></font></font>
<p><b><font face="Verdana"><font color="#FFFFFF"><font size="-1">That's it!</font></font></font></b>
<br><font face="Verdana"><font size="-1">Compile the code and test out the
modification on your favorite level.</font></font>
<br><font face="Verdana"><font size="-1">To issue the command you can type
"kamikaze" in the console everytime, or bind a key:</font></font>
<br><i><font face="Verdana"><font size="-1">/bind k kamikaze</font></font></i>
<br><font face="Verdana"><font size="-1">Now whenever a player presses 'k'
they will kamikaze.</font></font><font face="Verdana"><font size="-1"></font></font>
<p><font face="Verdana"><font size="-1">Any players that you kill when you
kamikaze, you get a frag for their death.</font></font>
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;
<br><font face="Verdana"><font size="-1"></font></font>&nbsp;
</body>

<!-- SOME SCRIPT SRC'S ON THIS PAGE HAVE BEEN REWRITTEN BY THE WAYBACK MACHINE
OF THE INTERNET ARCHIVE IN ORDER TO PRESERVE THE TEMPORAL INTEGRITY OF THE SESSION. -->


<script language="Javascript">
<!--

// FILE ARCHIVED ON 20021110122251 AND RETRIEVED FROM THE
// INTERNET ARCHIVE ON 20070925073233.
// JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.
// ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
// SECTION 108(a)(3)).

   var sWayBackCGI = "https://web.archive.org/web/20071210024417/http://web.archive.org/web/20021110122251/";

   function xResolveUrl(url) {
      var image = new Image();
      image.src = url;
      return image.src;
   }
   function xLateUrl(aCollection, sProp) {
      var i = 0;
      for(i = 0; i < aCollection.length; i++) {
         if (typeof(aCollection[i][sProp]) == "string") { 
          if (aCollection[i][sProp].indexOf("mailto:") == -1 &&
             aCollection[i][sProp].indexOf("javascript:") == -1) {
            if(aCollection[i][sProp].indexOf("http") == 0) {
                aCollection[i][sProp] = sWayBackCGI + aCollection[i][sProp];
            } else {
                aCollection[i][sProp] = sWayBackCGI + xResolveUrl(aCollection[i][sProp]);
            }
         }
         }
      }
   }

   xLateUrl(document.getElementsByTagName("IMG"),"src");
   xLateUrl(document.getElementsByTagName("A"),"href");
   xLateUrl(document.getElementsByTagName("AREA"),"href");
   xLateUrl(document.getElementsByTagName("OBJECT"),"codebase");
   xLateUrl(document.getElementsByTagName("OBJECT"),"data");
   xLateUrl(document.getElementsByTagName("APPLET"),"codebase");
   xLateUrl(document.getElementsByTagName("APPLET"),"archive");
   xLateUrl(document.getElementsByTagName("EMBED"),"src");
   xLateUrl(document.getElementsByTagName("BODY"),"background");
   var forms = document.getElementsByTagName("FORM");
   if (forms) {
       var j = 0;
       for (j = 0; j < forms.length; j++) {
              f = forms[j];
              if (typeof(f.action)  == "string") {
                 if(typeof(f.method)  == "string") {
                     if(typeof(f.method) != "post") {
                        f.action = sWayBackCGI + f.action;
                     }
                  }
              }
        }
    }


//-->
</script>

</html><!--
     FILE ARCHIVED ON 02:44:17 Dec 10, 2007 AND RETRIEVED FROM THE
     INTERNET ARCHIVE ON 23:00:32 Jul 14, 2023.
     JAVASCRIPT APPENDED BY WAYBACK MACHINE, COPYRIGHT INTERNET ARCHIVE.

     ALL OTHER CONTENT MAY ALSO BE PROTECTED BY COPYRIGHT (17 U.S.C.
     SECTION 108(a)(3)).
-->
<!--
playback timings (ms):
  captures_list: 94.836
  exclusion.robots: 0.285
  exclusion.robots.policy: 0.266
  cdx.remote: 0.095
  esindex: 0.015
  LoadShardBlock: 65.725 (3)
  PetaboxLoader3.datanode: 67.22 (4)
  load_resource: 74.549
  PetaboxLoader3.resolve: 41.592
-->